<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>スケジュール一覧</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}" media="all" />
    <link rel="stylesheet" type="text/css" th:href="@{/css/schedule.css}" />
    <link rel='stylesheet' th:href="@{/webjars/fullcalendar/3.5.1/dist/fullcalendar.css}" />

	<script th:src="@{/js/jQuery-3.3.1.min.js}"></script>
	<script th:src="@{/webjars/moment/2.19.1/min/moment.min.js}"></script>
	<script th:src="@{/webjars/fullcalendar/3.5.1/dist/fullcalendar.js}"></script>
	<script type="text/javascript" th:inline="javascript">
	/*<![CDATA[*/
		$(document).ready(function() {
			let projectId = /*[[${projectId}]]*/0;
			let startDay = /*[[${startDate}]]*/null;
			let lastDay = /*[[${endDate}]]*/null;
			
			$('#calendar').fullCalendar({
				customButtons : {
					myCustomButton : {
						text : '課題追加',
						click : function() {
							location.href = "/project" + projectId + "/schedule/add";
						}
					}
				},
				buttonIcons : {
					prev: 'left-single-arrow',
					next: 'right-single-arrow'
				},
				eventSources : [ {
					url : '/api/event/all' + projectId
				} ],
				eventClick : function(info) {
					let url = "/project" + projectId + "/schedule/detail" + info.id;
					$.ajax({
						url : url,
						type : "GET",
					}).done(function(responseData) {
						location.href = url;
					}).fail(function() {
						console.log("errorばーか");
					})
				},
				header : {
					left : 'prev, title, next',
					right : 'myCustomButton'
				},
				defaultDate: startDay,
				validRange: {
			      start: startDay,
			      end: lastDay
			    },
				lang : 'ja',
				defaultView : 'agendaDay',
				height : 680
			});
		});
	/*]]>*/
	</script>
</head>
<body>
<header>
  <div class="head-menu">
    <p class="menu-title">旅行計画アプリ</p>
    <a class="user" href=""><img th:src="@{/img/user.png}"></a>
  </div>
  <div class="side-menu" style="display: inline">
    <nav class="gnav">
      <ul class="gnav-menu">
        <li><a th:href="@{'/project' + ${projectId} + '/schedule'}">スケジュール一覧</a></li>
        <li><a th:href="@{'/project' + ${projectId} + '/schedule/detail'}">スケジュール詳細</a></li>
        <li><a href="/question/2">アンケート一覧</a></li>
        <li><a th:href="@{'/project' + ${projectId} + '/edit'}">プロジェクト編集</a></li>
        <li><a href="/logout">ログアウト</a></li>
      </ul>
    </nav>
  </div>
  <div class="calender-flame"  style="width: 1100px; float: right; margin-right: 5px; margin-top: 10px"><div id='calendar'></div></div>
</header>
</body>
</html>
